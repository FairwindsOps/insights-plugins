apiVersion: audit.k8s.io/v1
kind: Policy
rules:
# Log all requests at RequestResponse level for deployments
- level: RequestResponse
  verbs: ["create", "update", "delete"]
  resources:
  - group: "apps"
    resources: ["deployments"]
  - group: "kyverno.io"
    resources: ["clusterpolicies"]
# Log metadata for all other requests
- level: Metadata
  verbs: ["get", "list", "watch"]
  resources:
  - group: "*"
    resources: ["*"]
