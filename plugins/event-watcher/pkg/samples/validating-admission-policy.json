{
    "kind": "Event",
    "apiVersion": "audit.k8s.io/v1",
    "level": "RequestResponse",
    "auditID": "c1c6d7a3-cd1d-45af-9b50-9e031a105894",
    "stage": "ResponseComplete",
    "requestURI": "/apis/apps/v1/namespaces/kyverno-james-test/deployments?fieldManager=kubectl-client-side-apply&fieldValidation=Strict",
    "verb": "create",
    "user": {
        "username": "arn:aws:sts::161177611123:assumed-role/FairwindsAdministrator/vault-oidc-105850934429965188282-admin-1761766112-u16qtPTesQb1BE",
        "uid": "aws-iam-authenticator:161177611123:AROASLBXPFNZUU5HVCEQP",
        "groups": [
            "kubernetes-admins",
            "system:authenticated"
        ],
        "extra": {
            "accessKeyId": [
                "ASIASLBXPFNZ3PPQGTAR"
            ],
            "arn": [
                "arn:aws:sts::161177611123:assumed-role/FairwindsAdministrator/vault-oidc-105850934429965188282-admin-1761766112-u16qtPTesQb1BE"
            ],
            "canonicalArn": [
                "arn:aws:iam::161177611123:role/FairwindsAdministrator"
            ],
            "principalId": [
                "AROASLBXPFNZUU5HVCEQP"
            ],
            "sessionName": [
                "vault-oidc-105850934429965188282-admin-1761766112-u16qtPTesQb1BE"
            ],
            "sigs.k8s.io/aws-iam-authenticator/principalId": [
                "AROASLBXPFNZUU5HVCEQP"
            ]
        }
    },
    "sourceIPs": [
        "187.104.131.35"
    ],
    "userAgent": "kubectl/v1.32.5 (darwin/amd64) kubernetes/9894294",
    "objectRef": {
        "resource": "deployments",
        "namespace": "kyverno-james-test",
        "name": "nginx-deployment",
        "apiGroup": "apps",
        "apiVersion": "v1"
    },
    "responseStatus": {
        "metadata": {},
        "status": "Failure",
        "message": "deployments.apps \"nginx-deployment\" is forbidden: ValidatingAdmissionPolicy 'check-deployment-replicas' with binding 'check-deployment-replicas-binding' denied request: failed expression: object.spec.replicas >= 5",
        "reason": "Invalid",
        "details": {
            "name": "nginx-deployment",
            "group": "apps",
            "kind": "deployments",
            "causes": [
                {
                    "message": "ValidatingAdmissionPolicy 'check-deployment-replicas' with binding 'check-deployment-replicas-binding' denied request: failed expression: object.spec.replicas >= 5"
                }
            ]
        },
        "code": 422
    },
    "requestObject": {
        "kind": "Deployment",
        "apiVersion": "apps/v1",
        "metadata": {
            "name": "nginx-deployment",
            "namespace": "kyverno-james-test",
            "creationTimestamp": null,
            "labels": {
                "app": "nginx",
                "app.kubernetes.io/name": "james123"
            },
            "annotations": {
                "kubectl.kubernetes.io/last-applied-configuration": "{\"apiVersion\":\"apps/v1\",\"kind\":\"Deployment\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"nginx\",\"app.kubernetes.io/name\":\"james123\"},\"name\":\"nginx-deployment\",\"namespace\":\"kyverno-james-test\"},\"spec\":{\"replicas\":1,\"selector\":{\"matchLabels\":{\"app\":\"nginx\"}},\"template\":{\"metadata\":{\"labels\":{\"app\":\"nginx\"}},\"spec\":{\"containers\":[{\"image\":\"nginx:1.19\",\"name\":\"nginx2\",\"ports\":[{\"containerPort\":80}]}]}}}}\n"
            }
        },
        "spec": {
            "replicas": 1,
            "selector": {
                "matchLabels": {
                    "app": "nginx"
                }
            },
            "template": {
                "metadata": {
                    "creationTimestamp": null,
                    "labels": {
                        "app": "nginx"
                    }
                },
                "spec": {
                    "containers": [
                        {
                            "name": "nginx2",
                            "image": "nginx:1.19",
                            "ports": [
                                {
                                    "containerPort": 80,
                                    "protocol": "TCP"
                                }
                            ],
                            "resources": {},
                            "terminationMessagePath": "/dev/termination-log",
                            "terminationMessagePolicy": "File",
                            "imagePullPolicy": "IfNotPresent"
                        }
                    ],
                    "restartPolicy": "Always",
                    "terminationGracePeriodSeconds": 30,
                    "dnsPolicy": "ClusterFirst",
                    "securityContext": {},
                    "schedulerName": "default-scheduler"
                }
            },
            "strategy": {
                "type": "RollingUpdate",
                "rollingUpdate": {
                    "maxUnavailable": "25%",
                    "maxSurge": "25%"
                }
            },
            "revisionHistoryLimit": 10,
            "progressDeadlineSeconds": 600
        },
        "status": {}
    },
    "responseObject": {
        "kind": "Status",
        "apiVersion": "v1",
        "metadata": {},
        "status": "Failure",
        "message": "deployments.apps \"nginx-deployment\" is forbidden: ValidatingAdmissionPolicy 'check-deployment-replicas' with binding 'check-deployment-replicas-binding' denied request: failed expression: object.spec.replicas >= 5",
        "reason": "Invalid",
        "details": {
            "name": "nginx-deployment",
            "group": "apps",
            "kind": "deployments",
            "causes": [
                {
                    "message": "ValidatingAdmissionPolicy 'check-deployment-replicas' with binding 'check-deployment-replicas-binding' denied request: failed expression: object.spec.replicas >= 5"
                }
            ]
        },
        "code": 422
    },
    "requestReceivedTimestamp": "2025-10-29T19:37:23.867161Z",
    "stageTimestamp": "2025-10-29T19:37:23.879241Z",
    "annotations": {
        "authorization.k8s.io/decision": "allow",
        "authorization.k8s.io/reason": "RBAC: allowed by ClusterRoleBinding \"rbac-manager-definition-cluster-admins-cluster-admin\" of ClusterRole \"cluster-admin\" to Group \"kubernetes-admins\""
    }
}