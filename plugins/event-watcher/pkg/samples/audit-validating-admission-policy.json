{
    "kind": "Event",
    "apiVersion": "audit.k8s.io/v1",
    "level": "RequestResponse",
    "auditID": "dd8cc062-f5a4-4f74-9321-91af79646bf9",
    "stage": "ResponseComplete",
    "requestURI": "/apis/apps/v1/namespaces/kyverno-james-test/deployments?fieldManager=kubectl-client-side-apply\u0026fieldValidation=Strict",
    "verb": "create",
    "user": {
        "username": "kubernetes-admin",
        "groups": [
            "kubeadm:cluster-admins",
            "system:authenticated"
        ],
        "extra": {
            "authentication.kubernetes.io/credential-id": [
                "X509SHA256=f89969c8139ed0c2a2099916797046ba17d32aa342d2a21ec0d7bc490479becc"
            ]
        }
    },
    "sourceIPs": [
        "172.18.0.1"
    ],
    "userAgent": "kubectl/v1.31.5 (darwin/amd64) kubernetes/af64d83",
    "objectRef": {
        "resource": "deployments",
        "namespace": "kyverno-james-test",
        "name": "james1-deployment",
        "apiGroup": "apps",
        "apiVersion": "v1"
    },
    "responseStatus": {
        "metadata": {},
        "code": 201
    },
    "requestObject": {
        "kind": "Deployment",
        "apiVersion": "apps/v1",
        "metadata": {
            "name": "james1-deployment",
            "namespace": "kyverno-james-test",
            "creationTimestamp": null,
            "labels": {
                "app": "nginx",
                "app.kubernetes.io/name": "nginx",
                "team": "team1"
            },
            "annotations": {
                "kubectl.kubernetes.io/last-applied-configuration": "{\"apiVersion\":\"apps/v1\",\"kind\":\"Deployment\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"nginx\",\"app.kubernetes.io/name\":\"nginx\",\"team\":\"team1\"},\"name\":\"james1-deployment\",\"namespace\":\"kyverno-james-test\"},\"spec\":{\"replicas\":1,\"selector\":{\"matchLabels\":{\"app\":\"nginx\"}},\"template\":{\"metadata\":{\"labels\":{\"app\":\"nginx\"}},\"spec\":{\"containers\":[{\"image\":\"nginx:1.19\",\"name\":\"nginx2\",\"ports\":[{\"containerPort\":80}],\"securityContext\":{\"allowPrivilegeEscalation\":true,\"privileged\":true,\"readOnlyRootFilesystem\":false,\"runAsNonRoot\":true,\"runAsUser\":1000}}]}}}}\n"
            }
        },
        "spec": {
            "replicas": 1,
            "selector": {
                "matchLabels": {
                    "app": "nginx"
                }
            },
            "template": {
                "metadata": {
                    "creationTimestamp": null,
                    "labels": {
                        "app": "nginx"
                    }
                },
                "spec": {
                    "containers": [
                        {
                            "name": "nginx2",
                            "image": "nginx:1.19",
                            "ports": [
                                {
                                    "containerPort": 80,
                                    "protocol": "TCP"
                                }
                            ],
                            "resources": {},
                            "terminationMessagePath": "/dev/termination-log",
                            "terminationMessagePolicy": "File",
                            "imagePullPolicy": "IfNotPresent",
                            "securityContext": {
                                "privileged": true,
                                "runAsUser": 1000,
                                "runAsNonRoot": true,
                                "readOnlyRootFilesystem": false,
                                "allowPrivilegeEscalation": true
                            }
                        }
                    ],
                    "restartPolicy": "Always",
                    "terminationGracePeriodSeconds": 30,
                    "dnsPolicy": "ClusterFirst",
                    "securityContext": {},
                    "schedulerName": "default-scheduler"
                }
            },
            "strategy": {
                "type": "RollingUpdate",
                "rollingUpdate": {
                    "maxUnavailable": "25%",
                    "maxSurge": "25%"
                }
            },
            "revisionHistoryLimit": 10,
            "progressDeadlineSeconds": 600
        },
        "status": {}
    },
    "responseObject": {
        "kind": "Deployment",
        "apiVersion": "apps/v1",
        "metadata": {
            "name": "james1-deployment",
            "namespace": "kyverno-james-test",
            "uid": "bdc605fa-dc12-43c5-82b3-afebb2292e14",
            "resourceVersion": "3928",
            "generation": 1,
            "creationTimestamp": "2025-10-31T17:00:38Z",
            "labels": {
                "app": "nginx",
                "app.kubernetes.io/name": "nginx",
                "team": "team1"
            },
            "annotations": {
                "kubectl.kubernetes.io/last-applied-configuration": "{\"apiVersion\":\"apps/v1\",\"kind\":\"Deployment\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"nginx\",\"app.kubernetes.io/name\":\"nginx\",\"team\":\"team1\"},\"name\":\"james1-deployment\",\"namespace\":\"kyverno-james-test\"},\"spec\":{\"replicas\":1,\"selector\":{\"matchLabels\":{\"app\":\"nginx\"}},\"template\":{\"metadata\":{\"labels\":{\"app\":\"nginx\"}},\"spec\":{\"containers\":[{\"image\":\"nginx:1.19\",\"name\":\"nginx2\",\"ports\":[{\"containerPort\":80}],\"securityContext\":{\"allowPrivilegeEscalation\":true,\"privileged\":true,\"readOnlyRootFilesystem\":false,\"runAsNonRoot\":true,\"runAsUser\":1000}}]}}}}\n"
            },
            "managedFields": [
                {
                    "manager": "kubectl-client-side-apply",
                    "operation": "Update",
                    "apiVersion": "apps/v1",
                    "time": "2025-10-31T17:00:38Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                        "f:metadata": {
                            "f:annotations": {
                                ".": {},
                                "f:kubectl.kubernetes.io/last-applied-configuration": {}
                            },
                            "f:labels": {
                                ".": {},
                                "f:app": {},
                                "f:app.kubernetes.io/name": {},
                                "f:team": {}
                            }
                        },
                        "f:spec": {
                            "f:progressDeadlineSeconds": {},
                            "f:replicas": {},
                            "f:revisionHistoryLimit": {},
                            "f:selector": {},
                            "f:strategy": {
                                "f:rollingUpdate": {
                                    ".": {},
                                    "f:maxSurge": {},
                                    "f:maxUnavailable": {}
                                },
                                "f:type": {}
                            },
                            "f:template": {
                                "f:metadata": {
                                    "f:labels": {
                                        ".": {},
                                        "f:app": {}
                                    }
                                },
                                "f:spec": {
                                    "f:containers": {
                                        "k:{\"name\":\"nginx2\"}": {
                                            ".": {},
                                            "f:image": {},
                                            "f:imagePullPolicy": {},
                                            "f:name": {},
                                            "f:ports": {
                                                ".": {},
                                                "k:{\"containerPort\":80,\"protocol\":\"TCP\"}": {
                                                    ".": {},
                                                    "f:containerPort": {},
                                                    "f:protocol": {}
                                                }
                                            },
                                            "f:resources": {},
                                            "f:securityContext": {
                                                ".": {},
                                                "f:allowPrivilegeEscalation": {},
                                                "f:privileged": {},
                                                "f:readOnlyRootFilesystem": {},
                                                "f:runAsNonRoot": {},
                                                "f:runAsUser": {}
                                            },
                                            "f:terminationMessagePath": {},
                                            "f:terminationMessagePolicy": {}
                                        }
                                    },
                                    "f:dnsPolicy": {},
                                    "f:restartPolicy": {},
                                    "f:schedulerName": {},
                                    "f:securityContext": {},
                                    "f:terminationGracePeriodSeconds": {}
                                }
                            }
                        }
                    }
                }
            ]
        },
        "spec": {
            "replicas": 1,
            "selector": {
                "matchLabels": {
                    "app": "nginx"
                }
            },
            "template": {
                "metadata": {
                    "creationTimestamp": null,
                    "labels": {
                        "app": "nginx"
                    }
                },
                "spec": {
                    "containers": [
                        {
                            "name": "nginx2",
                            "image": "nginx:1.19",
                            "ports": [
                                {
                                    "containerPort": 80,
                                    "protocol": "TCP"
                                }
                            ],
                            "resources": {},
                            "terminationMessagePath": "/dev/termination-log",
                            "terminationMessagePolicy": "File",
                            "imagePullPolicy": "IfNotPresent",
                            "securityContext": {
                                "privileged": true,
                                "runAsUser": 1000,
                                "runAsNonRoot": true,
                                "readOnlyRootFilesystem": false,
                                "allowPrivilegeEscalation": true
                            }
                        }
                    ],
                    "restartPolicy": "Always",
                    "terminationGracePeriodSeconds": 30,
                    "dnsPolicy": "ClusterFirst",
                    "securityContext": {},
                    "schedulerName": "default-scheduler"
                }
            },
            "strategy": {
                "type": "RollingUpdate",
                "rollingUpdate": {
                    "maxUnavailable": "25%",
                    "maxSurge": "25%"
                }
            },
            "revisionHistoryLimit": 10,
            "progressDeadlineSeconds": 600
        },
        "status": {}
    },
    "requestReceivedTimestamp": "2025-10-31T17:00:38.846436Z",
    "stageTimestamp": "2025-10-31T17:00:38.858244Z",
    "annotations": {
        "authorization.k8s.io/decision": "allow",
        "authorization.k8s.io/reason": "RBAC: allowed by ClusterRoleBinding \"kubeadm:cluster-admins\" of ClusterRole \"cluster-admin\" to Group \"kubeadm:cluster-admins\"",
        "validation.policy.admission.k8s.io/validation_failure": "[{\"message\":\"failed expression: object.spec.replicas \\u003e= 5\",\"policy\":\"check-deployment-replicas\",\"binding\":\"check-deployment-replicas-binding\",\"expressionIndex\":0,\"validationActions\":[\"Audit\"]}]"
    }
}