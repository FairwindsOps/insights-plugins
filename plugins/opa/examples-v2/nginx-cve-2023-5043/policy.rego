package fairwinds

noConfigurationSnippet[actionItem] {
  input.kind == "Ingress"
  input.metadata.annotations["nginx.ingress.kubernetes.io/configuration-snippet"]
  actionItem := {
    "title": "Ingress is using configuration snippet annotation",
    "description": "CVE-2023-5043",
    "remediation": "Annotation validation should be enabled in the cluster",
    "category": "Security",
    "severity": 0.7,
  }
}