output:
  title: "Creating resources in this namespace is forbidden"
  severity: 0.1
  remediation: "Move this resource to a different namespace"
  category: "Reliability"
rego: |
        package fairwinds
        blockedNamespace(elem) {
          ns := elem.parameters.blocklist[_]
          elem.metadata.namespace == ns
        }
        notinnamespace[results] {
          not blockedNamespace(input)
          namespace := input.parameters.namespaces[_]
          input.metadata.namespace == namespace
          description := sprintf("Namespace %v is forbidden", [namespace])
          results := description
        }
