output:
  title: "Label is present"
  severity: 0.1
  remediation: "Remove the label"
  category: "Reliability"
rego: |
        package fairwinds
        blockedNamespace(elem) {
          ns := elem.parameters.blocklist[_]
          elem.metadata.namespace == ns
        }
        labelblock[description] {
          not blockedNamespace(input)
          provided := {label | input.metadata.labels[label]}
          required := {label | label := input.parameters.labels[_]}
          missing := required - provided
          found := required - missing
          count(found) > 0
          description := sprintf("Label %v is present", [found])
        }
