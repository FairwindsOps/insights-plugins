output:
  title: "Deployment is out of date"
  severity: 0.1
  remediation: "Update this deployment"
  category: "Reliability"
rego: |
        package fairwinds
        latestReplicaDateFresh(replicaSets, elem) {
          rs := replicaSets[_]
          owner := rs.metadata.ownerRefrences[_]
          owner.uid == elem.metadata.uid
          rs.status.replicas > 0
          comparisonDate := time.add_date(time.now_ns(), 0, 0, -input.parameters.days)
          time.parse_rfc3339_ns(rs.metadata.creationTimestamp) < comparisonDate
        }
        hparequired[description] {
          not latestReplicaDateFresh(kubernetes("apps", "ReplicaSet"), input)
          description := "No fresh replica sets found"
        }
