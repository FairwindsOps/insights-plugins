output:
  title: "Annotation is missing"
  severity: 0.1
  remediation: "Add the annotation"
  category: "Reliability"
rego: |
        package fairwinds
        blockedNamespace(elem) {
          ns := elem.parameters.blocklist[_]
          elem.metadata.namespace == ns
        }
        annotationrequired[description] {
          not blockedNamespace(input)
          provided := {annotation | input.metadata.annotations[annotation]}
          required := {annotation | annotation := input.parameters.annotations[_]}
          missing := required - provided
          count(missing) > 0
          description := sprintf("Annotation %v is missing", [missing])
        }
