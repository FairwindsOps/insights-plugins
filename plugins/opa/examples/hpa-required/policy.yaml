output:
  title: "HPA is required"
  severity: 0.1
  remediation: "Create an HPA"
  category: "Reliability"
rego: |
        package fairwinds
        contains(hpas, elem) {
          hpa := hpas[_]
          hpa.spec.scaleTargetRef.kind == elem.kind
          hpa.spec.scaleTargetRef.name == elem.metadata.name
          hpa.metadata.namespace == elem.metadata.namespace
          hpa.spec.scaleTargetRef.apiVersion == elem.apiVersion
        }
        hparequired[description] {
          not contains(kubernetes("autoscaling", "HorizontalPodAutoscaler"), input)
          description := "No horizontal pod autoscaler found"
        }
