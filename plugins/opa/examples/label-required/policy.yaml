output:
  title: "Label is missing"
  severity: 0.1
  remediation: "Add the label"
  category: "Reliability"
rego: |
        package fairwinds
        blockedNamespace(elem) {
          ns := elem.parameters.blocklist[_]
          elem.metadata.namespace == ns
        }
        labelrequired[results] {
          not blockedNamespace(input)
          provided := {label | input.metadata.labels[label]}
          required := {label | label := input.parameters.labels[_]}
          missing := required - provided
          count(missing) > 0
          description := sprintf("Label %v is missing", [missing])
          severity := 0.1 * count(missing)
          results := {
            "description": description,
            "severity": severity,
          }
        }
